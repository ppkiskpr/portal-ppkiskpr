<!doctype html>
<html lang="ms" class="h-full">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Portal Rasmi PPKI SK Paya Resak</title>

  <style>
    :root{
      /* ===== Fixed Theme ===== */
      --brand:#1F6F4A;        /* main green */
      --brand2:#0f4f34;       /* darker green */
      --accent:#111827;       /* dark text */
      --muted:#6b7280;
      --bg:#f3f4f6;           /* light background */
      --card:#ffffff;
      --card2:#f9fafb;
      --border:#e5e7eb;
      --shadow: 0 12px 28px rgba(17,24,39,.08);

      /* layout */
      --radius:18px;
      --radius2:22px;
      --rail:72px;            /* icon rail width */
      --sidebarW:280px;       /* expanded sidebar */
      --contentMax: 1180px;
    }

    html[data-mode="dark"]{
      --bg:#0b1220;
      --accent:rgba(255,255,255,.92);
      --muted:rgba(255,255,255,.65);
      --card:#111827;
      --card2:#0f172a;
      --border:rgba(255,255,255,.12);
      --shadow: 0 18px 50px rgba(0,0,0,.45);
      --brand:#1F6F4A;
      --brand2:#0f4f34;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      background: var(--bg);
      color: var(--accent);
      min-height:100vh;
    }
    a{color:inherit;text-decoration:none}
    button,input,select{font-family:inherit}
    .app{display:flex;min-height:100vh}

    /* ===== Desktop: icon rail (always) ===== */
    .rail{
      width: var(--rail);
      background: #0b0f1a;
      color: rgba(255,255,255,.92);
      display:flex;
      flex-direction:column;
      align-items:center;
      padding: 10px 8px;
      gap: 10px;
      position: sticky;
      top:0;
      height: 100vh;
      z-index: 30;
    }
    html[data-mode="dark"] .rail{
      background:#060a12;
    }

    .railLogo{
      width:48px;height:48px;border-radius:16px;
      background: rgba(255,255,255,.10);
      display:grid;place-items:center;
      border:1px solid rgba(255,255,255,.14);
      overflow:hidden;
      cursor:pointer;
      user-select:none;
    }
    .railLogo img{width:100%;height:100%;object-fit:cover;display:block}
    .railBtn{
      width:48px;height:48px;border-radius:16px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      display:grid;place-items:center;
      cursor:pointer;
      user-select:none;
      transition: transform .04s ease, background .15s ease;
      font-size:18px;
    }
    .railBtn:hover{ background: rgba(255,255,255,.10); }
    .railBtn:active{ transform: translateY(1px); }
    .railBtn.active{ background: rgba(31,111,74,.55); border-color: rgba(31,111,74,.55); }

    .railSpacer{flex:1}
    .railFooter{
      font-size:11px;
      opacity:.8;
      text-align:center;
      line-height:1.3;
      padding-bottom:6px;
      user-select:none;
    }

    /* ===== Expanded sidebar (optional) ===== */
    .sidebar{
      width: var(--sidebarW);
      background: var(--card);
      border-right:1px solid var(--border);
      padding: 14px 14px;
      position: sticky;
      top:0;
      height:100vh;
      overflow:auto;
      display:none; /* default collapsed */
      z-index: 25;
    }
    body.sidebar-open .sidebar{ display:block; }

    .brandBox{
      border:1px solid var(--border);
      border-radius: var(--radius2);
      padding: 12px;
      background: var(--card2);
      display:flex; gap:10px; align-items:center;
      cursor:pointer;
      user-select:none;
    }
    .brandBox .logo{
      width:44px;height:44px;border-radius:16px;
      background: rgba(31,111,74,.14);
      border:1px solid var(--border);
      overflow:hidden;
      display:grid;place-items:center;
      flex:0 0 auto;
    }
    .brandBox .logo img{width:100%;height:100%;object-fit:cover;display:block}
    .brandBox .t{min-width:0}
    .brandBox .t .name{font-weight:900;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .brandBox .t .motto{font-size:12px;color:var(--muted);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}

    .sideList{margin-top:12px;display:flex;flex-direction:column;gap:8px;}
    .sideItem{
      display:flex;align-items:center;gap:12px;
      border:1px solid transparent;
      border-radius: 16px;
      padding: 10px 12px;
      cursor:pointer;
      user-select:none;
      background: transparent;
      transition: background .15s ease, border-color .15s ease;
      font-weight:800;
    }
    .sideItem:hover{ background: var(--card2); border-color: var(--border); }
    .sideItem.active{ background: rgba(31,111,74,.12); border-color: rgba(31,111,74,.25); }
    .sideIcon{
      width:36px;height:36px;border-radius:14px;
      display:grid;place-items:center;
      border:1px solid var(--border);
      background: var(--card);
      flex:0 0 auto;
    }
    .sideFoot{
      margin-top:14px;
      border:1px solid var(--border);
      border-radius: var(--radius2);
      padding: 10px 12px;
      background: var(--card2);
      color: var(--muted);
      font-size:12px;
      line-height:1.4;
    }

    /* ===== Main area ===== */
    .main{
      flex:1;
      min-width:0;
      padding: 14px 16px 26px;
    }

    .topbar{
      max-width: var(--contentMax);
      margin: 0 auto;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding: 12px 14px;
      border-radius: var(--radius2);
      background: var(--card);
      border:1px solid var(--border);
      box-shadow: var(--shadow);
      position: sticky;
      top: 10px;
      z-index: 20;
    }

    .topLeft{display:flex;align-items:center;gap:10px;min-width:0;}
    .hamburger{
      width:44px;height:44px;border-radius:16px;
      border:1px solid var(--border);
      background: var(--card2);
      display:grid;place-items:center;
      cursor:pointer;
      user-select:none;
      font-size:18px;
    }
    .pageTitleWrap{min-width:0}
    .pageTitle{font-weight:950;letter-spacing:.2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .pageSub{font-size:12px;color:var(--muted);margin-top:2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}

    .topRight{display:flex;align-items:center;gap:10px;}
    .iconBtn{
      width:44px;height:44px;border-radius:16px;
      border:1px solid var(--border);
      background: var(--card2);
      display:grid;place-items:center;
      cursor:pointer;
      user-select:none;
      font-size:18px;
    }

    /* ===== Content layout ===== */
    .content{
      max-width: var(--contentMax);
      margin: 14px auto 0;
      display:flex;
      flex-direction:column;
      gap: 12px;
    }

    .banner{
      border-radius: var(--radius2);
      padding: 14px 16px;
      background: linear-gradient(90deg, var(--brand2), var(--brand));
      color: #fff;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
      box-shadow: var(--shadow);
    }
    html[data-mode="dark"] .banner{
      box-shadow: 0 18px 55px rgba(0,0,0,.5);
    }
    .banner h1{margin:0;font-size:22px;letter-spacing:.2px}
    .banner .timeBox{
      background: rgba(255,255,255,.16);
      border:1px solid rgba(255,255,255,.25);
      padding: 10px 12px;
      border-radius: 16px;
      font-weight:900;
      white-space:nowrap;
    }

    .gridStats{
      display:grid;
      grid-template-columns: repeat(4, minmax(0, 1fr));
      gap: 12px;
    }
    .statCard{
      background: var(--card);
      border:1px solid var(--border);
      border-radius: var(--radius2);
      padding: 14px;
      box-shadow: var(--shadow);
      min-width:0;
    }
    .statLabel{font-size:13px;color:var(--muted);font-weight:900}
    .statValue{margin-top:6px;font-size:30px;font-weight:1000;letter-spacing:.2px}
    .statSub{margin-top:2px;font-size:12px;color:var(--muted);font-weight:900}

    .panelRow{
      display:grid;
      grid-template-columns: 1fr 2fr; /* left announcements, right trend chart */
      gap: 12px;
      align-items:start;
    }

    .card{
      background: var(--card);
      border:1px solid var(--border);
      border-radius: var(--radius2);
      padding: 14px;
      box-shadow: var(--shadow);
      min-width:0;
    }
    .cardHead{
      display:flex;align-items:flex-start;justify-content:space-between;gap:10px;
      margin-bottom: 8px;
    }
    .cardHead h2{margin:0;font-size:16px;letter-spacing:.2px}
    .sub{margin:0;color:var(--muted);font-size:12px;font-weight:800}

    .pillRow{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .pill{
      border:1px solid var(--border);
      background: var(--card2);
      padding: 8px 12px;
      border-radius: 999px;
      cursor:pointer;
      user-select:none;
      font-weight:950;
      color: var(--muted);
    }
    .pill.active{
      background: rgba(31,111,74,.14);
      border-color: rgba(31,111,74,.28);
      color: var(--accent);
    }

    .field{
      border:1px solid var(--border);
      background: var(--card2);
      color: var(--accent);
      padding: 10px 12px;
      border-radius: 14px;
      outline:none;
      font-weight:900;
    }

    /* announcement items */
    .annList{display:flex;flex-direction:column;gap:10px;}
    .annItem{
      border:1px solid var(--border);
      background: var(--card2);
      border-radius: 18px;
      padding: 12px;
      cursor:pointer;
      user-select:none;
    }
    .annTitle{font-weight:1000;margin:0 0 6px 0}
    .annMeta{font-size:12px;color:var(--muted);font-weight:900;margin:0}

    /* chart area */
    .chartWrap{
      border:1px solid var(--border);
      background: var(--card2);
      border-radius: 18px;
      padding: 10px;
      overflow:hidden;
    }

    /* ===== Attendance/Table Page ===== */
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .btn{
      border:1px solid var(--border);
      background: var(--card2);
      color: var(--accent);
      padding: 10px 12px;
      border-radius: 14px;
      cursor:pointer;
      user-select:none;
      font-weight:1000;
    }
    .btnPrimary{
      background: rgba(31,111,74,.14);
      border-color: rgba(31,111,74,.28);
    }

    .tableWrap{
      margin-top: 12px;
      overflow:auto;
      border-radius: 18px;
      border:1px solid var(--border);
      background: var(--card);
    }
    table{border-collapse:separate;border-spacing:0;width:100%;min-width:860px}
    th,td{padding:10px 10px;border-bottom:1px solid var(--border);vertical-align:top}
    th{position:sticky;top:0;background: var(--card);text-align:left;font-size:12px;color:var(--muted);font-weight:1000}
    td{font-size:13px}
    tr:hover td{background: rgba(31,111,74,.06)}
    html[data-mode="dark"] tr:hover td{background: rgba(255,255,255,.03)}

    .badge{
      display:inline-flex;align-items:center;gap:6px;
      padding: 6px 10px;border-radius:999px;
      border:1px solid var(--border);
      background: var(--card2);
      font-weight:1000;font-size:12px;
    }
    .bOk{background: rgba(34,197,94,.12);border-color: rgba(34,197,94,.28)}
    .bNo{background: rgba(239,68,68,.12);border-color: rgba(239,68,68,.28)}
    .bHi{background: rgba(245,158,11,.12);border-color: rgba(245,158,11,.30)}

    /* ===== Modals ===== */
    .overlay{
      position:fixed;inset:0;background: rgba(0,0,0,.55);
      display:none;z-index:70;padding:14px;overflow:auto;
    }
    .overlay.show{display:block}
    .modal{
      width:min(980px,100%);
      margin: 40px auto;
      background: var(--card);
      border:1px solid var(--border);
      border-radius: 22px;
      box-shadow: 0 22px 80px rgba(0,0,0,.45);
      overflow:hidden;
      display:flex;flex-direction:column;
      max-height: calc(100vh - 80px);
    }
    .modalHead{
      display:flex;align-items:center;justify-content:space-between;gap:10px;
      padding: 14px;
      border-bottom:1px solid var(--border);
      background: var(--card2);
    }
    .modalHead h3{margin:0;font-size:15px;font-weight:1000}
    .modalBody{padding:14px;overflow:auto}

    .warnBox{
      border:1px solid rgba(239,68,68,.35);
      background: rgba(239,68,68,.12);
      border-radius: 16px;
      padding: 10px 12px;
      font-weight:1000;
      display:none;
      margin-top: 10px;
    }
    .warnBox.show{display:block}

    /* ===== Responsive ===== */
    @media (max-width: 1100px){
      .gridStats{grid-template-columns: repeat(2, minmax(0, 1fr));}
      .panelRow{grid-template-columns: 1fr;}
    }
    @media (max-width: 860px){
      /* Mobile practical */
      .rail{display:none;} /* hide rail on mobile */
      .sidebar{
        display:block;
        position:fixed;
        left:0;top:0;height:100vh;
        transform: translateX(-105%);
        z-index:80;
        box-shadow: 0 25px 70px rgba(0,0,0,.55);
      }
      body.sidebar-open .sidebar{ transform: translateX(0); }
      .main{padding: 12px;}
      .topbar{top: 8px;}
      .banner{flex-direction:column;align-items:flex-start}
      .banner h1{font-size:18px}
      .banner .timeBox{align-self:flex-end}
      .gridStats{grid-template-columns: repeat(2, minmax(0, 1fr));}
      .statValue{font-size:26px}
      table{min-width: 780px;}
    }
  </style>
</head>

<body>
<div class="app">

  <aside class="rail" id="rail">
    <div class="railLogo" id="railHome" title="Home">
      <span id="railLogoFallback" style="font-weight:1000;">üè´</span>
      <img id="railLogoImg" alt="" style="display:none;">
    </div>

    <div class="railBtn" id="railToggle" title="Buka/Tutup Menu">‚ò∞</div>

    <div class="railBtn active" data-page="home" title="Laman Utama">üè†</div>
    <div class="railBtn" data-page="attendance" title="Kehadiran">üßæ</div>
    <div class="railBtn" data-page="pajsk" title="PAJSK">üéñÔ∏è</div> <div class="railBtn" data-page="announcements" title="Pengumuman">üì¢</div>
    <div class="railBtn" data-page="calendar" title="Takwim">üóìÔ∏è</div>
    <div class="railBtn" data-page="parents" title="Ibu Bapa">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</div>

    <div class="railSpacer"></div>

    <div class="railBtn" id="railMode" title="Mode Cerah/Gelap">üåô</div>
    <div class="railBtn" id="railSettings" title="Tetapan">‚öôÔ∏è</div>

    <div class="railFooter" id="railFooterText">
      ¬© 2025<br/>NK
    </div>
  </aside>

  <aside class="sidebar" id="sidebar">
    <div class="brandBox" id="brandGoHome">
      <div class="logo" id="sideLogo">
        <span style="font-weight:1000;">üè´</span>
      </div>
      <div class="t">
        <div class="name" id="schoolNameSide">SK Paya Resak</div>
        <div class="motto" id="schoolMottoSide">Moving Forward</div>
      </div>
    </div>

    <div class="sideList" id="sideList">
      <div class="sideItem active" data-page="home"><div class="sideIcon">üè†</div> Laman Utama</div>
      <div class="sideItem" data-page="attendance"><div class="sideIcon">üßæ</div> Kehadiran</div>
      <div class="sideItem" data-page="pajsk"><div class="sideIcon">üéñÔ∏è</div> PAJSK</div> <div class="sideItem" data-page="announcements"><div class="sideIcon">üì¢</div> Pengumuman</div>
      <div class="sideItem" data-page="calendar"><div class="sideIcon">üóìÔ∏è</div> Takwim</div>
      <div class="sideItem" data-page="parents"><div class="sideIcon">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</div> Ibu Bapa</div>
    </div>

    <div class="sideFoot">
      <div id="footerLine1Side">¬© 2025 NK.</div>
      <div id="footerLine2Side">Hak Cipta Terpelihara.</div>
    </div>
  </aside>

  <main class="main">
    <header class="topbar">
      <div class="topLeft">
        <button class="hamburger" id="btnMenu" title="Menu">‚ò∞</button>
        <div class="pageTitleWrap">
          <div class="pageTitle" id="pageTitle">Laman Utama</div>
          <div class="pageSub" id="pageSub">Portal Rasmi PPKI</div>
        </div>
      </div>
      <div class="topRight">
        <button class="iconBtn" id="btnReload" title="Muat Semula">‚ü≥</button>
        <button class="iconBtn" id="btnMode" title="Mode Cerah/Gelap">üåô</button>
        <button class="iconBtn" id="btnSettings" title="Tetapan">‚öôÔ∏è</button>
      </div>
    </header>

    <section class="content">

      <div class="page" id="page-home">
        <div class="banner">
          <h1 id="bannerText">Selamat Datang ke Portal Rasmi PPKI SK Paya Resak</h1>
          <div class="timeBox" id="timeNow">Ahad, 28 Disember 2025 ¬∑ 00:00:00</div>
        </div>

        <div class="gridStats">
          <div class="statCard">
            <div class="statLabel">Kehadiran Hari Ini</div>
            <div class="statValue" id="vToday">-</div>
            <div class="statSub" id="sToday">‚Äî</div>
          </div>
          <div class="statCard">
            <div class="statLabel">Kehadiran Minggu Ini</div>
            <div class="statValue" id="vWeek">-</div>
            <div class="statSub" id="sWeek">‚Äî</div>
          </div>
          <div class="statCard">
            <div class="statLabel">Kehadiran Bulan Ini</div>
            <div class="statValue" id="vMonth">-</div>
            <div class="statSub" id="sMonth">‚Äî</div>
          </div>
          <div class="statCard">
            <div class="statLabel">% Kehadiran Bulanan</div>
            <div class="statValue" id="vPct">-</div>
            <div class="statSub" id="sPct">Bulan semasa</div>
          </div>
        </div>

        <div class="panelRow">
          <div class="card">
            <div class="cardHead">
              <div>
                <h2>Status Pengumuman Aktif</h2>
                <p class="sub" id="annCount">‚Äî</p>
              </div>
              <button class="btn" id="btnToAnnouncements">Lihat Semua</button>
            </div>
            <div class="annList" id="annListHome"></div>
          </div>

          <div class="card">
            <div class="cardHead">
              <div>
                <h2>Trend Harian (Bulan Dipilih)</h2>
                <p class="sub">Pilih Bulan + Kelas dan mod paparan.</p>
              </div>
            </div>

            <div class="pillRow" id="trendMode">
              <div class="pill active" data-mode="hadir">Hadir</div>
              <div class="pill" data-mode="tidak">Tidak Hadir</div>
              <div class="pill" data-mode="pct">%</div>

              <select class="field" id="trendMonth"></select>
              <select class="field" id="trendYear"></select>
              <select class="field" id="trendClass"><option value="">Semua Kelas</option></select>
            </div>

            <div style="margin-top:10px" class="chartWrap">
              <div id="trendChart"></div>
            </div>

            <p class="sub" style="margin-top:10px">
              *Graf ringkas berdasarkan data kehadiran (Tarikh dd/mm/yyyy).
            </p>
          </div>
        </div>
      </div>

      <div class="page" id="page-attendance" style="display:none;">
        <div class="card">
          <div class="cardHead">
            <div>
              <h2>Dashboard Kehadiran</h2>
              <p class="sub">Filter ini akan ubah sekali statistik kad di atas (ikut kelas/status/date range/carian).</p>
            </div>
            <div class="row">
              <button class="btn" id="btnReloadAttendance">Muat Semula Data</button>
            </div>
          </div>

          <div class="gridStats" style="margin-top:10px">
            <div class="statCard">
              <div class="statLabel">Kehadiran Hari Ini</div>
              <div class="statValue" id="vToday2">-</div>
              <div class="statSub" id="sToday2">‚Äî</div>
            </div>
            <div class="statCard">
              <div class="statLabel">Ke
